\chapter{Исследовательский раздел}
В данном разделе проводится исследование эффективности разработанного метода миграции данных.
Проводится исследование зависимостей времени конвертации схемы от количества столбцов в таблицах 
и глубины вложенности документов. 
Описывается исследование зависимости объема выделяемой памяти при миграции данных 
от количества вложенных документов в схеме.

\section{Исследование зависимости объема памяти от глубины вложенности}
Процесс миграции данных существенно требователен по памяти.
В связи с этим было проведено исследование зависимости выделяемой памяти в основных сегментах реализации метода.

Платформа JVM предоставляет инструментарий для профилирования разработанных приложений.
Для замеров выделенной памяти использовался JDK Flight Recorder (JFR).

Для проведения исследования была сформирована база данных, 
состоящая из 15 таблиц связанных в древовидную структуру.
Структура БД представлена на рисунке \ref{img:tree_test}.
\includeimage{tree_test}{f}{h}{0.95\textwidth}{Древовидная структура БД для исследования}

\clearpage

Далее производились замеры выделенной памяти при миграции схемы и миграции данных. 
Также замерялось общее потребление памяти. 
Варьировалась глубина вложенности и как следствие количество и размер документов.

На рисунке \ref{img:allocated_memory} представлены результаты исследования.
\includeimage{allocated_memory}{f}{h}{\textwidth}{Зависимость количества выделенной памяти к глубине вложенности}

\section*{Выводы}
В ходе исследования было выявлено, 
что денормализация структуры не приводит
к росту потребляемой памяти, в то время как, 
миграция сильно денормализованной схемы требует больше памяти.
Также при детальном рассмотрении количества потребляемой памяти
было выявлено, что при отображении отношения в ссылку требуется столько же памяти,
сколько при создании вложенного документа, при этом выполняется больше запросов к БД.
Из чего можно сделать вывод, что следует отдавать предпочтение денормализации схемы 
при миграции схем содержащих большое количество сущностей.

Исходя из наблюдений за количеством выделяемой памяти также следует 
необходимость оценки доступной оперативной памяти при миграции больших объемов данных.  

\clearpage

\section{Исследование зависимости времени конвертации схемы от глубины вложенности формируемого документа}
Формирование схемы является одним из основных этапов метода и определяет дальнейшие преобразования.
По времени формирования схемы можно оценить время миграции без влияния сторонних факторов.

Для того, чтобы замерить время конвертации схемы был реализован дополнительный модуль, 
который не учитывал время ввода-вывода и подсчитывал время затраченное на преобразование конкретной схемы.
Исследование проводилось на базе данных, структура которой обозначена на рисунке \ref{img:tree_test}.

На рисунке \ref{img:tree_depth_time} представлен график зависимости времени формирования схемы, 
от глубины формируемого дерева документов.

\includeimage{tree_depth_time}{f}{h}{\textwidth}{Зависимость времени формирования схемы от глубины вложенности}

Также были произведены замеры времени конвертации в зависимости от количества столбцов в таблице.
\clearpage
График зависимости приведен на рисунке \ref{img:time_columns}.
\includeimage{time_columns}{f}{h}{\textwidth}{Зависимость времени конвертации от количества столбцов}


\section*{Выводы}
Исходя из результатов исследования можно сделать вывод, 
что время конвертации растет пропорционально глубине вложенности формируемого документа.
Количество столбцов в каждой таблице практически не влияет на время конвертации так как занимает наносекунды.
 
По полученным результатам можно судить о эффективности разработанного метода 
и о применимости к миграции относительно больших объемов данных.

